[
    {
        "context": "Stolen credentials",
        "technique": "T1003",
        "metadata": {
            "page_number": 2,
            "id": "001",
            "source": "TEXT",
            "tactic_name": [
                "CREDENTIAL ACCESS"
            ],
            "tactic": [
                "TA0006"
            ],
            "technique_name": "OS CREDENTAIL DUMPING",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "This involves extracting account login information from operating systems and software, such as username-password pairs, hashes, or other forms of authentication credentials.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "Deployed webshell URLs",
        "technique": "T1505",
        "metadata": {
            "page_number": 2,
            "id": "002",
            "source": "TEXT",
            "tactic_name": [
                "PERSISTENCE"
            ],
            "tactic": [
                "TA0003"
            ],
            "technique_name": "SERVER SOFTWARE COMPONENT",
            "sub_technique_name": "WEB SHELL",
            "sub_technique": "T1505.003",
            "description": "This involves installing a web shell on a compromised web server to gain persistent access to the server.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "Backdoor tools",
        "technique": "T1105",
        "metadata": {
            "page_number": 2,
            "id": "003",
            "source": "TEXT",
            "tactic_name": [
                "COMMAND AND CONTROL"
            ],
            "tactic": [
                "TA0011"
            ],
            "technique_name": "INGRESS TOOL TRANSFER",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "Backdoors are tools that allow attackers to gain unauthorized access to systems, often bypassing security controls.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "The credentials appear to have been stolen via multiple techniques, including using post-exploition password recovery tools such as MimiKatz or its variant ZhuMimiKatz",
        "technique": "T1003",
        "metadata": {
            "page_number": 5,
            "id": "004",
            "source": "TEXT",
            "tactic_name": [
                "CREDENTIAL ACCESS"
            ],
            "tactic": [
                "TA0006"
            ],
            "technique_name": "CREDENTIAL DUMPING",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "The act of extracting credentials from a compromised system.",
            "tool_name": [
                "MIMIKATZ"
            ],
            "tool": [
                "S0002"
            ],
            "note": null,
            "link": null
        }
    },
    {
        "context": "we believe OilRig attackers obtained credentials through, bruteforcing, SQL injections, and using traditional credential harvesting toolkits",
        "technique": "T1110",
        "metadata": {
            "page_number": 5,
            "id": "030",
            "source": "TEXT",
            "tactic_name": [
                "CREDENTIAL ACCESS"
            ],
            "tactic": [
                "TA0006"
            ],
            "technique_name": "BRUTE FORCE",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "we believe OilRig attackers obtained credentials through, bruteforcing, SQL injections, and using traditional credential harvesting toolkits",
        "technique": "T1190",
        "metadata": {
            "page_number": 5,
            "id": "031",
            "source": "TEXT",
            "tactic_name": [
                "INITIAL ACCESS"
            ],
            "tactic": [
                "TA0001"
            ],
            "technique_name": "EXPLOIT PUBLIC-FACING APPLICATIONS",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "we had internally postulated the OilRig group likely had a propensity to immediately attempt to escalate privileges once they have their initial compromise",
        "technique": "T1068",
        "metadata": {
            "page_number": 5,
            "id": "032",
            "source": "TEXT",
            "tactic_name": [
                "PRIVILEGE ESCALATION"
            ],
            "tactic": [
                "TA0004"
            ],
            "technique_name": "EXPLOITATION FOR PRIVILEGE ESCALATION",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "Adversaries may exploit software vulnerabilities in an attempt to elevate privileges.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "then try to move laterally into the local Microsoft Exchange server where they would then able to harvest more credentials",
        "technique": "T1003",
        "metadata": {
            "page_number": 5,
            "id": "005",
            "source": "TEXT",
            "tactic_name": [
                "CREDENTIAL ACCESS"
            ],
            "tactic": [
                "TA0006"
            ],
            "technique_name": "OS CREDENTIAL DUMPING",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "Once on the Exchange server, OilRig extracts credentials, which can be used to further compromise additional systems within the network.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "implant additional tools such as webshells",
        "technique": "T1505",
        "metadata": {
            "page_number": 5,
            "id": "006",
            "source": "TEXT",
            "tactic_name": [
                "PERSISTENCE"
            ],
            "tactic": [
                "TA0003"
            ],
            "technique_name": "SERVER SOFTWARE COMPONENT",
            "sub_technique_name": "WEB SHELL",
            "sub_technique": "T1505.003",
            "description": "To maintain persistence, OilRig deploys web shells on compromised servers. Web shells allow remote access and command execution, facilitating ongoing control over the compromised server.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "Ruler is an open-source penetration testing toolkit which is predicated on being able to access Outlook Web Access (OWA) or OWA via stolen credentials,",
        "technique": "T1114",
        "metadata": {
            "page_number": 5,
            "id": "007",
            "source": "TEXT",
            "tactic_name": [
                "COLLECTION"
            ],
            "tactic": [
                "TA0009"
            ],
            "technique_name": "EMAIL COLLECTION",
            "sub_technique_name": "REMOTE EMAIL COLLECTION",
            "sub_technique": "T1114.002",
            "description": "Ruler is an open-source tool used by OilRig to exploit OWA by setting malicious rules, retrieving the Global Address List, and executing code remotely. This tool leverages the built-in functionalities of Microsoft Exchange to maintain stealth and efficiency in their operations.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "performing remote code execution",
        "technique": "T1059",
        "metadata": {
            "page_number": 5,
            "id": "008",
            "source": "TEXT",
            "tactic_name": [
                "EXECUTION"
            ],
            "tactic": [
                "TA0002"
            ],
            "technique_name": "COMMAND AND SCRIPTING INTERPRETER",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "Using Ruler, OilRig can execute arbitrary commands on the Exchange server. This includes retrieving data, executing scripts, and deploying additional malware.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "BONDUPDATER tool used DNS tunneling to communicate with its C2, specifically using TXT queries to receive information from the C2 server",
        "technique": "T1071",
        "metadata": {
            "page_number": 6,
            "id": "009",
            "source": "TEXT",
            "tactic_name": [
                "COMMAND AND CONTROL"
            ],
            "tactic": [
                "TA0011"
            ],
            "technique_name": "APPLICATION LAYER PROTOCOL",
            "sub_technique_name": "DNS",
            "sub_technique": "T1071.004",
            "description": "The malware communicates with its C2 server using DNS queries, specifically leveraging DNS TXT records.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "BONDUPDATER tool used DNS tunneling to communicate with its C2, specifically using TXT queries to receive information from the C2 server",
        "technique": "T1048",
        "metadata": {
            "page_number": 6,
            "id": "033",
            "source": "TEXT",
            "tactic_name": [
                "EXFILTRATION"
            ],
            "tactic": [
                "TA0010"
            ],
            "technique_name": "EXFILTRATION OVER ALTERNATIVE PROTOCOL",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "Alternate protocols include FTP, SMTP, HTTP/S, DNS, SMB, or any other network protocol not being used as the main command and control channel.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "Powershell scripts meant to run on compromised systems.",
        "technique": "T1059",
        "metadata": {
            "page_number": 6,
            "id": "010",
            "source": "TEXT",
            "tactic_name": [
                "EXECUTION"
            ],
            "tactic": [
                "TA0002"
            ],
            "technique_name": "COMMAND AND SCRIPTING INTERPRETER",
            "sub_technique_name": "POWERSHELL",
            "sub_technique": "T1059.001",
            "description": "Adversaries use PowerShell to run malicious scripts, download additional payloads, or execute commands directly.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "Command and control server that communicates via DNS tunneling",
        "technique": "T1071",
        "metadata": {
            "page_number": 6,
            "id": "011",
            "source": "TEXT",
            "tactic_name": [
                "COMMAND AND CONTROL"
            ],
            "tactic": [
                "TA0011"
            ],
            "technique_name": "APPLICATION LAYER PROTOCOL",
            "sub_technique_name": "DNS",
            "sub_technique": "T1071.004",
            "description": "This technique involves using DNS queries and responses to communicate between the C2 server and the compromised system. DNS tunneling allows data to be hidden within DNS traffic, which can bypass traditional network defenses.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "Graphical User Interface that allows actors to issue commands, upload and download files to Agents via the Server",
        "technique": "T1105",
        "metadata": {
            "page_number": 6,
            "id": "012",
            "source": "TEXT",
            "tactic_name": [
                "COMMAND AND CONTROL"
            ],
            "tactic": [
                "TA0011"
            ],
            "technique_name": "INGRESS TOOL TRANSFER",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "This technique involves transferring tools or files to a compromised system. A GUI that allows file uploads and downloads is directly related to this technique, enabling operators to manage files on the compromised system through the C2 server.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "Glimpse is a PowerShell script",
        "technique": "T1059",
        "metadata": {
            "page_number": 6,
            "id": "013",
            "source": "TEXT",
            "tactic_name": [
                "EXECUTION"
            ],
            "tactic": [
                "TA0002"
            ],
            "technique_name": "COMMAND AND SCRIPTING INTERPRETER",
            "sub_technique_name": "POWERSHELL",
            "sub_technique": "T1059.001",
            "description": null,
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "The panel allows the actors to issue commands in addition to uploading files to and downloading files from the compromised endpoints.",
        "technique": "T1105",
        "metadata": {
            "page_number": 6,
            "id": "014",
            "source": "TEXT",
            "tactic_name": [
                "COMMAND AND CONTROL"
            ],
            "tactic": [
                "TA0011"
            ],
            "technique_name": "INGRESS TOOL TRANSFER",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "The panel allows file uploads and downloads is directly related to this technique, enabling operators to manage files on the compromised system through the C2 server.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "The server portion of Glimpse works in unison with the panel by acting as a DNS server, which is written in JavaScript and runs in the Node.js runtime.",
        "technique": "T1071",
        "metadata": {
            "page_number": 7,
            "id": "015",
            "source": "TEXT",
            "tactic_name": [
                "COMMAND AND CONTROL"
            ],
            "tactic": [
                "TA0011"
            ],
            "technique_name": "APPLICATION LAYER PROTCOL",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "This technique involves using application layer protocols for C2 communication. The Glimpse server's role as a DNS server to handle commands and responses fits within this technique, where DNS is used as an application layer protocol.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "The Poison Frog server handles both the HTTP and DNS tunneling channels used by thehUpdater.ps1anddUpdater.ps1scripts.",
        "technique": "T1071",
        "metadata": {
            "page_number": 9,
            "id": "016",
            "source": "TEXT",
            "tactic_name": [
                "COMMAND AND CONTROL"
            ],
            "tactic": [
                "TA0011"
            ],
            "technique_name": "APPLICATION LAYER PROTOCOL",
            "sub_technique_name": "WEB PROTCOLS",
            "sub_technique": "T1071.001",
            "description": "The Poison Frog server uses HTTP for command and control (C2) communication. This technique involves using web protocols to send and receive data between the compromised system and the C2 server.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "The initial TwoFace loader samples decrypted an embedded webshell using an actor provided key, which was modified by using simple arithmetic operators (\"+\" or \"-\" specifically) and a salt string embedded within the loader webshell, whose result decrypts an embedded payload using simple arithmetic operators (again, \"+\" or \"-\" specifically)",
        "technique": "T1140",
        "metadata": {
            "page_number": 11,
            "id": "017",
            "source": "TEXT",
            "tactic_name": [
                "DEFENSE EVASION"
            ],
            "tactic": [
                "TA0005"
            ],
            "technique_name": "DEOBFUSCATE/DECODE FILES OR INFORMATION",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "This process is designed to obscure the true nature of the payload, requiring decryption before it can be analyzed.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "the TwoFace++ loader used the 3DES cipher and a SHA256 hash of a string provided by the actor and used as a key, so we were unable to extract the embedded webshells as we were unable to determine the actor provided key",
        "technique": "T1486",
        "metadata": {
            "page_number": 11,
            "id": "018",
            "source": "TEXT",
            "tactic_name": [
                "IMPACT"
            ],
            "tactic": [
                "TA0040"
            ],
            "technique_name": "DATA ENCRYPTED FOR IMPACT",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "This encryption method enhances security but also complicates efforts to analyze the malware without the correct decryption key.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "Append a string to the password that acts as a salt",
        "technique": "T1027",
        "metadata": {
            "page_number": 11,
            "id": "019",
            "source": "TEXT",
            "tactic_name": [
                "DEFENSE EVASION"
            ],
            "tactic": [
                "TA0005"
            ],
            "technique_name": "OBFUSCATED FILES OR INFORMATION",
            "sub_technique_name": "BINARY PADDING",
            "sub_technique": "T1027.001",
            "description": "The use of a salt appended to the password before generating the SHA1 hash adds an extra layer of obfuscation, making it more challenging to brute force or predict the hash.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": [
                "020"
            ]
        }
    },
    {
        "context": "Obtain the SHA1 hash of the resulting string containing the password and salt Base64 encode the SHA1 hash Compare the encoded hash with hardcoded base64 string",
        "technique": "T1566",
        "metadata": {
            "page_number": 11,
            "id": "020",
            "source": "TEXT",
            "tactic_name": [
                "CREDENTIAL ACCESS",
                "DEFENSE EVASION",
                "PERSISTENCE"
            ],
            "tactic": [
                "TA0006",
                "TA0005",
                "TA0003"
            ],
            "technique_name": "MODIFY AUTHENTICATION PROCESS",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "The TwoFace++ loader modifies the authentication process by requiring a password and a salt to generate a hash. This hash is then compared against a hardcoded string to authenticate the inbound request. This modification in the authentication mechanism is a technique used to control access to the embedded",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": [
                "019",
                "021"
            ]
        }
    },
    {
        "context": "Base64 encodes the SHA256 hash and uses the first 24 characters as a key",
        "technique": "T1486",
        "metadata": {
            "page_number": 11,
            "id": "021",
            "source": "TEXT",
            "tactic_name": [
                "IMPACT"
            ],
            "tactic": [
                "TA0040"
            ],
            "technique_name": "DATA ENCRYPTED FOR IMPACT",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "The process of using the 3DES cipher and a derived 24-character key (from the SHA256 hash) to decrypt the embedded webshell indicates an advanced encryption technique aimed at protecting the payload from unauthorized access.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": [
                "020",
                "022"
            ]
        }
    },
    {
        "context": "Uses 24-character key and the 3DES cipher to decrypt the embedded webshell",
        "technique": "T1140",
        "metadata": {
            "page_number": 11,
            "id": "022",
            "source": "TEXT",
            "tactic_name": [
                "DEFENSE EVASION"
            ],
            "tactic": [
                "TA0005"
            ],
            "technique_name": "DEOBFUSCATE/DECODE FILES OR INFORMATION",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "The steps to decode and decrypt the embedded webshell demonstrate the use of sophisticated decryption routines that must be followed to retrieve and execute the payload.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "The webshell will use the 7za module to archive files from the Explorer tab",
        "technique": "T1560",
        "metadata": {
            "page_number": 15,
            "id": "023",
            "source": "TEXT",
            "tactic_name": [
                ""
            ],
            "tactic": [
                null
            ],
            "technique_name": "ARCHIVE COLLECTED DATA",
            "sub_technique_name": "ARCHIVE VIA UTILITY",
            "sub_technique": "T1560.001",
            "description": "The webshell uses the 7za module (7-Zip), a well-known file archiving utility, to compress and archive files from the Explorer tab.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "the nbtscan module allows the webshell to scan the network for systems to build an IP list of system it can interact with.",
        "technique": "T1046",
        "metadata": {
            "page_number": 15,
            "id": "024",
            "source": "TEXT",
            "tactic_name": [
                "DISCOVERY"
            ],
            "tactic": [
                "TA0007"
            ],
            "technique_name": "NETWORK SERVICE DISCOVERY",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "The nbtscan module is employed by the webshell to scan the network and create a list of IP addresses for systems it can interact with. This type of scanning is typically used to identify potential targets within a network.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "To use this functionality, the actor must provide information within the \"Target Computer\" portion of the webshell, specifically a network administrator username and password, as well as a list of IP addresses of remote systems added in the \"Select Computer\" drop down",
        "technique": "T1078",
        "metadata": {
            "page_number": 15,
            "id": "025",
            "source": "TEXT",
            "tactic_name": [
                "DEFENSE EVASION",
                "PERSISTENCE",
                "PRIVILEGE ESCALATION",
                "INITIAL ACCESS"
            ],
            "tactic": [
                "TA0005",
                "TA0003",
                "TA0004",
                "TA0001"
            ],
            "technique_name": "VALID ACCOUNTS",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "The webshell uses valid credentials (network administrator username and password) to authenticate and access remote systems. This aligns with using stolen or compromised credentials to gain unauthorized access to network resources.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "to determine if it has more than 30 GB of free space. If the server has less than 30 GB of free space the webshell will not perform the activity, which indicates that the developer of the webshell expects a high volume of data downloaded from the victim network",
        "technique": "T1030",
        "metadata": {
            "page_number": 16,
            "id": "026",
            "source": "TEXT",
            "tactic_name": [
                "EXFILTRATION"
            ],
            "tactic": [
                "TA0010"
            ],
            "technique_name": "DATA TRANSFER SIZE LIMITS",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "The webshell checks for available storage space (ensuring more than 30 GB is free) before initiating the network download. This could be associated with techniques that avoid triggering alarms or detections related to large data transfers by ensuring the operation has sufficient space to proceed.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "The Network Downloader function will gather all the files in these folders and use 7-Zip to compress and archive the files.",
        "technique": "T1560",
        "metadata": {
            "page_number": 16,
            "id": "027",
            "source": "TEXT",
            "tactic_name": [
                "COLLECTION"
            ],
            "tactic": [
                "TA0009"
            ],
            "technique_name": "ARCHIVE COLLECTED DATA",
            "sub_technique_name": null,
            "sub_technique": null,
            "description": "The use of 7-Zip to compress and archive files before exfiltration is a classic example of this technique. Attackers often compress data to reduce its size, facilitate transfer, or obscure its contents.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "The webshell will save the archives locally to the server in theC:\\Users\\Public\\Libraries\\Recorded\\Filesfolder,",
        "technique": "T1074",
        "metadata": {
            "page_number": 16,
            "id": "028",
            "source": "TEXT",
            "tactic_name": [
                "COLLECTION"
            ],
            "tactic": [
                "TA0009"
            ],
            "technique_name": "DATA STAGED",
            "sub_technique_name": "LOCAL DATA STAGIN",
            "sub_technique": "T1074.001",
            "description": "Storing the compressed archives in the `C",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    },
    {
        "context": "remote desktop (RDP) sessions showing the Glimpse panel",
        "technique": "T1021",
        "metadata": {
            "page_number": 18,
            "id": "029",
            "source": "TEXT",
            "tactic_name": [
                "LATERAL MOVEMENT"
            ],
            "tactic": [
                "TA0008"
            ],
            "technique_name": "REMOTE SERVICES",
            "sub_technique_name": "REMOTE DESKTOP PROTOCOL",
            "sub_technique": "T1021.001",
            "description": "The use of RDP sessions to access and operate the Glimpse panel indicates the use of remote desktop services to control and manage compromised systems.",
            "tool_name": null,
            "tool": null,
            "note": null,
            "link": null
        }
    }
]